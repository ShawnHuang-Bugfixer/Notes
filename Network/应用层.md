# HTTP

## 请求方法与幂等性

![[attachments/Pasted image 20250517190632.png]]

## 状态码

![[attachments/Pasted image 20250517190731.png]]

## 短连接、长连接

HTTP/1.0 中默认为短连接，TCP 三次握手后，发送 HTTP 请求，服务端返回响应后，立即四次挥手关闭 TCP 连接。

HTTP/1.1中默认为长连接，TCP 三次握手建立连接后，在一次连接有效期内，复用该 TCP 连接，传输多个 HTTP 请求。

## HTTP 版本迭代与优化

**HTTP/1.1：**  
引入了长连接（Persistent Connection），允许多个 HTTP 请求复用一条 TCP 连接。但请求/响应必须**按顺序**进行，即请求 A 的响应必须完整返回后，请求 B 才能开始处理，导致**前一个请求变慢会阻塞后续请求** —— 这就是“应用层的队头阻塞”。

**HTTP/2：**  
引入了“流（Stream）”和“帧（Frame）”的机制，支持在**单个 TCP 连接上实现真正的多路复用**。每个请求对应一个独立的流，被拆解为多个帧交错传输，实现并发处理，从而解决了 HTTP/1.1 的应用层队头阻塞问题。但由于底层仍基于 TCP，**一旦底层丢包，所有流都必须等待重传完成**，因此**仍存在 TCP 层的队头阻塞问题**。

**HTTP/3：**  
基于 UDP 协议构建，通过 QUIC 协议实现了可靠传输。QUIC 在传输层就支持多路复用，**每个流独立传输、独立重传**，彻底解决了 TCP 层队头阻塞的问题，也带来了更快的连接建立和更好的传输性能。
# HTTPS

HTTPS 基于 SSL/TLS 协议，采用“非对称加密 + 对称加密”的混合加密机制，确保网络通信的**机密性、完整性与身份认证**。

### 1. 连接建立与加密方式

- 客户端与服务端通过 TLS 握手建立连接。
    
- 握手过程中，客户端使用服务端的公钥（或使用密钥交换算法如 ECDHE）安全地协商出一套对称加密密钥（Session Key）。
    
- 后续数据传输阶段，客户端与服务端使用该对称密钥对通信内容进行加密，提升加解密效率。
    

### 2. 身份认证与 CA 证书机制

- 为防止中间人攻击，HTTPS 引入了第三方权威机构（CA）颁发的数字证书机制。
    
- 服务端通过向 CA 提交公钥及域名等信息，申请数字证书。
    
- CA 对证书内容进行哈希摘要，然后使用其私钥对摘要进行签名，生成数字签名，形成完整证书（含服务端公钥和签名）。
    

### 3. 客户端验证证书有效性

- 客户端收到服务端证书后，会使用本地操作系统或浏览器中预置的 CA 公钥解密数字签名，得到原始摘要值。
    
- 同时客户端自行对证书内容计算哈希值，与解密后的摘要值对比：
    
    - 如果一致，说明证书未被篡改，服务端身份可信；
        
    - 若不一致，说明证书可能被伪造或中间人篡改。
        

### 4. 安全保障

- 通过 **非对称加密** 保证密钥协商过程的安全；
    
- 通过 **对称加密** 高效保护数据传输内容；
    
- 通过 **CA 签发的数字证书与签名机制** 实现身份验证与防篡改；
    
- 通过 **临时密钥交换算法（如 ECDHE）** 实现前向保密（PFS），即使私钥泄露也无法解密历史通信内容。

# DNS

DNS（Domain Name System）域名管理系统解析域名并返回域名对应的 IP 地址。

## 四种 DNS 服务器

- 本地域名服务器
- 权威域名服务器
- 顶级域名服务器
- 根域名服务器

## DNS 解析模式

DNS 查询分为两种模式：

- 迭代
- 递归

![[attachments/Pasted image 20250517194756.png]]
![[attachments/Pasted image 20250517194811.png]]

# WebSocket

TCP 连接上进行全双工通信的协议，建立客户端和服务器之间的通信渠道。浏览器和服务器仅需一次握手，两者之间就直接可以创建持久性的连接，并进行双向数据传输。

WebSocket 的工作过程可以分为以下几个步骤：

1. 客户端向服务器发送一个 HTTP 请求，请求头中包含 `Upgrade: websocket` 和 `Sec-WebSocket-Key` 等字段，表示要求升级协议为 WebSocket；
2. 服务器收到这个请求后，会进行升级协议的操作，如果支持 WebSocket，它将回复一个 HTTP 101 状态码，响应头中包含 ，`Connection: Upgrade`和 `Sec-WebSocket-Accept: xxx` 等字段、表示成功升级到 WebSocket 协议。
3. 客户端和服务器之间建立了一个 WebSocket 连接，可以进行双向的数据传输。数据以帧（frames）的形式进行传送，而不是传统的 HTTP 请求和响应。WebSocket 的每条消息可能会被切分成多个数据帧（最小单位）。发送端会将消息切割成多个帧发送给接收端，接收端接收消息帧，并将关联的帧重新组装成完整的消息。
4. 客户端或服务器可以主动发送一个关闭帧，表示要断开连接。另一方收到后，也会回复一个关闭帧，然后双方关闭 TCP 连接。

另外，建立 WebSocket 连接之后，通过心跳机制来保持 WebSocket 连接的稳定性和活跃性。
