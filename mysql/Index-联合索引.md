---
aliases:
  - 联合索引
date: 2025-04-05
tags:
  - MySQL进阶
---
# 联合索引的最左前缀原则详解

联合索引（复合索引）的最左前缀原则是数据库索引使用中的一个核心概念，理解这一原则对于正确设计和使用索引至关重要。

## 一、什么是最左前缀原则

最左前缀原则指的是：​**​联合索引中，查询条件必须从索引的最左列开始，并且不跳过中间的列​**​，才能有效使用该索引。

## 二、联合索引的结构

假设我们有一个联合索引 `INDEX(a, b, c)`，在B+树中的存储结构是：

1. 先按a列排序
2. a相同的情况下按b列排序
3. a和b都相同的情况下按c列排序

## 三、使用场景分析

### 1. 完全匹配（最佳情况）

sql

复制

```sql
WHERE a = 1 AND b = 2 AND c = 3
```

✅ 完全使用索引

### 2. 从左开始连续使用

sql

复制

```sql
WHERE a = 1 AND b = 2
WHERE a = 1
```

✅ 可以使用索引

### 3. 跳过左边列

sql

复制

```sql
WHERE b = 2
WHERE c = 3
WHERE b = 2 AND c = 3
```

❌ 无法使用该联合索引（除非有单独的b或c索引）

### 4. 中间有断开


```sql
WHERE a = 1 AND c = 3
```

⚠️ 只能使用到a列的索引部分，c列无法利用索引

## 四、特殊注意事项

1. ​**​范围查询后的列失效​**​：
    
    ```sql
    WHERE a = 1 AND b > 2 AND c = 3
    ```
    
    - 只能使用到a和b的索引，c无法使用索引
2. ​**​LIKE通配​**​：
    
    ```sql
    WHERE a LIKE 'abc%'  -- 可以使用索引
    WHERE a LIKE '%abc'  -- 无法使用索引
    ```
    
3. ​**​排序和分组​**​：
	
    ```sql
    ORDER BY a, b, c     -- 可以使用索引
    ORDER BY b, c        -- 无法使用该索引
    GROUP BY a, b, c     -- 可以使用索引
    ```
    

## 五、实际应用建议

1. ​**​高频查询条件放在最左​**​：将最常用作查询条件的列放在联合索引左侧
2. ​**​选择性高的列靠左​**​：区分度高的列（唯一值多）尽量靠左
3. ​**​避免冗余索引​**​：`INDEX(a,b,c)`已经包含`INDEX(a)`和`INDEX(a,b)`
4. ​**​考虑查询频率​**​：如果经常单独查询b列，可能需要单独为b建立索引

## 六、验证方法

使用`EXPLAIN`查看执行计划，关注：

- `key`：是否使用了预期的索引
- `key_len`：使用的索引长度（可判断用到了几列）
- `type`：访问类型（ref > range > index > ALL）